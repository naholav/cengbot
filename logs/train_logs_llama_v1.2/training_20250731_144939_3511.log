2025-07-31 14:49:39,421 - __main__ - INFO - Starting CengBot training pipeline...
2025-07-31 14:49:39,421 - __main__ - INFO - Setting up model and tokenizer...
2025-07-31 14:49:40,036 - __main__ - INFO - Found cached Llama models: ['models--meta-llama--Llama-3.2-3B']
2025-07-31 14:49:40,499 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-07-31 14:49:42,964 - __main__ - INFO - Loaded model: meta-llama/Llama-3.2-3B
2025-07-31 14:49:42,964 - __main__ - INFO - Model config: llama
2025-07-31 14:49:42,964 - __main__ - INFO - Hidden size: 3072
2025-07-31 14:49:42,964 - __main__ - INFO - Num layers: 28
2025-07-31 14:49:42,965 - __main__ - INFO - Total parameters: 3.2B
2025-07-31 14:49:42,965 - __main__ - INFO - Model dtype: torch.bfloat16
2025-07-31 14:49:43,134 - __main__ - INFO - Loading dataset from /home/arda/merged_qa_data.jsonl
2025-07-31 14:49:43,168 - __main__ - INFO - Loaded 22524 examples
2025-07-31 14:49:43,170 - __main__ - INFO - Turkish examples: 11187, English examples: 11337
2025-07-31 14:49:43,171 - __main__ - INFO - Train: 20948, Val TR: 783, Val EN: 793
2025-07-31 14:49:51,813 - __main__ - INFO - Pre-caching datasets in RAM...
2025-07-31 14:49:51,814 - __main__ - INFO - Datasets cached in RAM
2025-07-31 14:49:51,823 - __main__ - INFO - Starting training...
2025-07-31 14:50:58,923 - __main__ - INFO - Step 10/1312 - Train Loss: 2.9732
2025-07-31 14:52:04,323 - __main__ - INFO - Step 20/1312 - Train Loss: 2.5784
2025-07-31 14:53:09,911 - __main__ - INFO - Step 30/1312 - Train Loss: 1.8673
2025-07-31 14:54:15,482 - __main__ - INFO - Step 40/1312 - Train Loss: 1.4808
2025-07-31 14:55:21,073 - __main__ - INFO - Step 50/1312 - Train Loss: 1.2922
2025-07-31 14:56:26,674 - __main__ - INFO - Step 60/1312 - Train Loss: 1.2283
2025-07-31 14:57:44,948 - __main__ - INFO - Step 65/1312 - Eval Loss: 1.1097
2025-07-31 14:58:30,060 - __main__ - INFO - Step 65: TR Loss: 1.0576, EN Loss: 1.1694, Avg Loss: 1.1135
2025-07-31 14:59:03,607 - __main__ - INFO - Step 70/1312 - Train Loss: 1.1087
2025-07-31 15:00:09,199 - __main__ - INFO - Step 80/1312 - Train Loss: 1.0474
2025-07-31 15:01:14,777 - __main__ - INFO - Step 90/1312 - Train Loss: 1.0086
2025-07-31 15:02:20,404 - __main__ - INFO - Step 100/1312 - Train Loss: 1.0000
2025-07-31 15:03:26,074 - __main__ - INFO - Step 110/1312 - Train Loss: 0.9740
2025-07-31 15:04:31,678 - __main__ - INFO - Step 120/1312 - Train Loss: 0.9643
2025-07-31 15:05:37,218 - __main__ - INFO - Step 130/1312 - Train Loss: 0.9457
2025-07-31 15:06:22,577 - __main__ - INFO - Step 130/1312 - Eval Loss: 0.9296
2025-07-31 15:07:07,656 - __main__ - INFO - Step 130: TR Loss: 0.8891, EN Loss: 0.9771, Avg Loss: 0.9331
2025-07-31 15:08:13,919 - __main__ - INFO - Step 140/1312 - Train Loss: 0.9352
2025-07-31 15:09:19,491 - __main__ - INFO - Step 150/1312 - Train Loss: 0.9235
2025-07-31 15:10:25,054 - __main__ - INFO - Step 160/1312 - Train Loss: 0.9024
2025-07-31 15:11:30,670 - __main__ - INFO - Step 170/1312 - Train Loss: 0.8736
2025-07-31 15:12:36,268 - __main__ - INFO - Step 180/1312 - Train Loss: 0.8673
2025-07-31 15:13:41,848 - __main__ - INFO - Step 190/1312 - Train Loss: 0.8648
2025-07-31 15:15:00,252 - __main__ - INFO - Step 195/1312 - Eval Loss: 0.8604
2025-07-31 15:15:45,184 - __main__ - INFO - Step 195: TR Loss: 0.8235, EN Loss: 0.9041, Avg Loss: 0.8638
2025-07-31 15:16:18,616 - __main__ - INFO - Step 200/1312 - Train Loss: 0.8551
2025-07-31 15:17:24,074 - __main__ - INFO - Step 210/1312 - Train Loss: 0.8547
2025-07-31 15:18:30,475 - __main__ - INFO - Step 220/1312 - Train Loss: 0.8303
2025-07-31 15:19:36,086 - __main__ - INFO - Step 230/1312 - Train Loss: 0.8693
2025-07-31 15:20:41,707 - __main__ - INFO - Step 240/1312 - Train Loss: 0.8099
2025-07-31 15:21:47,319 - __main__ - INFO - Step 250/1312 - Train Loss: 0.8422
2025-07-31 15:22:52,997 - __main__ - INFO - Step 260/1312 - Train Loss: 0.8370
2025-07-31 15:23:38,379 - __main__ - INFO - Step 260/1312 - Eval Loss: 0.8172
2025-07-31 15:24:23,462 - __main__ - INFO - Step 260: TR Loss: 0.7796, EN Loss: 0.8617, Avg Loss: 0.8206
2025-07-31 15:25:29,686 - __main__ - INFO - Step 270/1312 - Train Loss: 0.8029
2025-07-31 15:26:35,366 - __main__ - INFO - Step 280/1312 - Train Loss: 0.7851
2025-07-31 15:27:41,026 - __main__ - INFO - Step 290/1312 - Train Loss: 0.7898
2025-07-31 15:28:46,670 - __main__ - INFO - Step 300/1312 - Train Loss: 0.7983
2025-07-31 15:29:52,330 - __main__ - INFO - Step 310/1312 - Train Loss: 0.7767
2025-07-31 15:30:57,880 - __main__ - INFO - Step 320/1312 - Train Loss: 0.8196
2025-07-31 15:32:16,164 - __main__ - INFO - Step 325/1312 - Eval Loss: 0.7892
2025-07-31 15:33:01,250 - __main__ - INFO - Step 325: TR Loss: 0.7563, EN Loss: 0.8285, Avg Loss: 0.7924
2025-07-31 15:33:30,357 - __main__ - INFO - Step 330/1312 - Train Loss: 0.7792
2025-07-31 15:34:35,998 - __main__ - INFO - Step 340/1312 - Train Loss: 0.7051
2025-07-31 15:35:41,521 - __main__ - INFO - Step 350/1312 - Train Loss: 0.7134
2025-07-31 15:36:47,123 - __main__ - INFO - Step 360/1312 - Train Loss: 0.7275
2025-07-31 15:37:52,675 - __main__ - INFO - Step 370/1312 - Train Loss: 0.6912
2025-07-31 15:38:58,280 - __main__ - INFO - Step 380/1312 - Train Loss: 0.7169
2025-07-31 15:40:03,901 - __main__ - INFO - Step 390/1312 - Train Loss: 0.7208
2025-07-31 15:40:49,303 - __main__ - INFO - Step 390/1312 - Eval Loss: 0.7701
2025-07-31 15:41:34,395 - __main__ - INFO - Step 390: TR Loss: 0.7381, EN Loss: 0.8087, Avg Loss: 0.7734
2025-07-31 15:42:40,773 - __main__ - INFO - Step 400/1312 - Train Loss: 0.7086
2025-07-31 15:43:46,494 - __main__ - INFO - Step 410/1312 - Train Loss: 0.7065
2025-07-31 15:44:52,054 - __main__ - INFO - Step 420/1312 - Train Loss: 0.7029
2025-07-31 15:45:57,714 - __main__ - INFO - Step 430/1312 - Train Loss: 0.7043
2025-07-31 15:47:03,392 - __main__ - INFO - Step 440/1312 - Train Loss: 0.6929
2025-07-31 15:48:09,040 - __main__ - INFO - Step 450/1312 - Train Loss: 0.6966
2025-07-31 15:49:27,376 - __main__ - INFO - Step 455/1312 - Eval Loss: 0.7541
2025-07-31 15:50:12,470 - __main__ - INFO - Step 455: TR Loss: 0.7211, EN Loss: 0.7937, Avg Loss: 0.7574
2025-07-31 15:50:46,057 - __main__ - INFO - Step 460/1312 - Train Loss: 0.6843
2025-07-31 15:51:51,635 - __main__ - INFO - Step 470/1312 - Train Loss: 0.6856
2025-07-31 15:52:57,312 - __main__ - INFO - Step 480/1312 - Train Loss: 0.7217
2025-07-31 15:54:03,008 - __main__ - INFO - Step 490/1312 - Train Loss: 0.6784
2025-07-31 15:55:08,666 - __main__ - INFO - Step 500/1312 - Train Loss: 0.6860
2025-07-31 15:56:14,241 - __main__ - INFO - Step 510/1312 - Train Loss: 0.7069
2025-07-31 15:57:19,894 - __main__ - INFO - Step 520/1312 - Train Loss: 0.6831
2025-07-31 15:58:05,291 - __main__ - INFO - Step 520/1312 - Eval Loss: 0.7372
2025-07-31 15:58:50,382 - __main__ - INFO - Step 520: TR Loss: 0.7046, EN Loss: 0.7763, Avg Loss: 0.7404
2025-07-31 15:59:56,602 - __main__ - INFO - Step 530/1312 - Train Loss: 0.7004
2025-07-31 16:01:02,242 - __main__ - INFO - Step 540/1312 - Train Loss: 0.6841
2025-07-31 16:02:07,931 - __main__ - INFO - Step 550/1312 - Train Loss: 0.6669
2025-07-31 16:03:13,574 - __main__ - INFO - Step 560/1312 - Train Loss: 0.6896
2025-07-31 16:04:19,142 - __main__ - INFO - Step 570/1312 - Train Loss: 0.6709
2025-07-31 16:05:24,762 - __main__ - INFO - Step 580/1312 - Train Loss: 0.6942
2025-07-31 16:06:43,121 - __main__ - INFO - Step 585/1312 - Eval Loss: 0.7220
2025-07-31 16:07:28,205 - __main__ - INFO - Step 585: TR Loss: 0.6925, EN Loss: 0.7579, Avg Loss: 0.7252
2025-07-31 16:08:01,820 - __main__ - INFO - Step 590/1312 - Train Loss: 0.6738
2025-07-31 16:09:07,501 - __main__ - INFO - Step 600/1312 - Train Loss: 0.6701
2025-07-31 16:10:13,166 - __main__ - INFO - Step 610/1312 - Train Loss: 0.6686
2025-07-31 16:11:18,837 - __main__ - INFO - Step 620/1312 - Train Loss: 0.6785
2025-07-31 16:12:24,571 - __main__ - INFO - Step 630/1312 - Train Loss: 0.6951
2025-07-31 16:13:30,167 - __main__ - INFO - Step 640/1312 - Train Loss: 0.6529
2025-07-31 16:14:35,886 - __main__ - INFO - Step 650/1312 - Train Loss: 0.6602
2025-07-31 16:15:21,282 - __main__ - INFO - Step 650/1312 - Eval Loss: 0.7111
2025-07-31 16:16:06,370 - __main__ - INFO - Step 650: TR Loss: 0.6819, EN Loss: 0.7465, Avg Loss: 0.7142
2025-07-31 16:17:08,304 - __main__ - INFO - Step 660/1312 - Train Loss: 0.6302
2025-07-31 16:18:14,031 - __main__ - INFO - Step 670/1312 - Train Loss: 0.5788
2025-07-31 16:19:19,738 - __main__ - INFO - Step 680/1312 - Train Loss: 0.5983
2025-07-31 16:20:25,392 - __main__ - INFO - Step 690/1312 - Train Loss: 0.5857
2025-07-31 16:21:31,051 - __main__ - INFO - Step 700/1312 - Train Loss: 0.5805
2025-07-31 16:22:36,779 - __main__ - INFO - Step 710/1312 - Train Loss: 0.5781
2025-07-31 16:23:55,115 - __main__ - INFO - Step 715/1312 - Eval Loss: 0.7154
2025-07-31 16:24:40,201 - __main__ - INFO - Step 715: TR Loss: 0.6894, EN Loss: 0.7480, Avg Loss: 0.7187
2025-07-31 16:25:13,763 - __main__ - INFO - Step 720/1312 - Train Loss: 0.5710
2025-07-31 16:26:19,403 - __main__ - INFO - Step 730/1312 - Train Loss: 0.5827
2025-07-31 16:27:25,040 - __main__ - INFO - Step 740/1312 - Train Loss: 0.5831
2025-07-31 16:28:30,729 - __main__ - INFO - Step 750/1312 - Train Loss: 0.5871
2025-07-31 16:29:36,291 - __main__ - INFO - Step 760/1312 - Train Loss: 0.5717
2025-07-31 16:30:41,973 - __main__ - INFO - Step 770/1312 - Train Loss: 0.5802
2025-07-31 16:31:47,584 - __main__ - INFO - Step 780/1312 - Train Loss: 0.5675
2025-07-31 16:32:32,972 - __main__ - INFO - Step 780/1312 - Eval Loss: 0.7063
2025-07-31 16:33:18,059 - __main__ - INFO - Step 780: TR Loss: 0.6769, EN Loss: 0.7424, Avg Loss: 0.7096
2025-07-31 16:34:24,372 - __main__ - INFO - Step 790/1312 - Train Loss: 0.5748
2025-07-31 16:35:30,065 - __main__ - INFO - Step 800/1312 - Train Loss: 0.5827
2025-07-31 16:36:35,764 - __main__ - INFO - Step 810/1312 - Train Loss: 0.5648
2025-07-31 16:37:41,385 - __main__ - INFO - Step 820/1312 - Train Loss: 0.5649
2025-07-31 16:38:47,081 - __main__ - INFO - Step 830/1312 - Train Loss: 0.5520
2025-07-31 16:39:52,808 - __main__ - INFO - Step 840/1312 - Train Loss: 0.5659
2025-07-31 16:41:11,143 - __main__ - INFO - Step 845/1312 - Eval Loss: 0.7011
2025-07-31 16:41:56,230 - __main__ - INFO - Step 845: TR Loss: 0.6745, EN Loss: 0.7341, Avg Loss: 0.7043
2025-07-31 16:42:29,817 - __main__ - INFO - Step 850/1312 - Train Loss: 0.5797
2025-07-31 16:43:35,375 - __main__ - INFO - Step 860/1312 - Train Loss: 0.5728
2025-07-31 16:44:41,033 - __main__ - INFO - Step 870/1312 - Train Loss: 0.5714
2025-07-31 16:45:46,579 - __main__ - INFO - Step 880/1312 - Train Loss: 0.5611
2025-07-31 16:46:52,256 - __main__ - INFO - Step 890/1312 - Train Loss: 0.5565
2025-07-31 16:47:57,916 - __main__ - INFO - Step 900/1312 - Train Loss: 0.5768
2025-07-31 16:49:03,482 - __main__ - INFO - Step 910/1312 - Train Loss: 0.5467
2025-07-31 16:49:48,910 - __main__ - INFO - Step 910/1312 - Eval Loss: 0.6976
2025-07-31 16:50:33,995 - __main__ - INFO - Step 910: TR Loss: 0.6693, EN Loss: 0.7324, Avg Loss: 0.7008
2025-07-31 16:51:40,370 - __main__ - INFO - Step 920/1312 - Train Loss: 0.5429
2025-07-31 16:52:45,994 - __main__ - INFO - Step 930/1312 - Train Loss: 0.5657
2025-07-31 16:53:51,577 - __main__ - INFO - Step 940/1312 - Train Loss: 0.5635
2025-07-31 16:54:57,227 - __main__ - INFO - Step 950/1312 - Train Loss: 0.5713
2025-07-31 16:56:02,917 - __main__ - INFO - Step 960/1312 - Train Loss: 0.5631
2025-07-31 16:57:08,493 - __main__ - INFO - Step 970/1312 - Train Loss: 0.5681
2025-07-31 16:58:26,851 - __main__ - INFO - Step 975/1312 - Eval Loss: 0.6920
2025-07-31 16:59:11,938 - __main__ - INFO - Step 975: TR Loss: 0.6636, EN Loss: 0.7268, Avg Loss: 0.6952
2025-07-31 16:59:45,511 - __main__ - INFO - Step 980/1312 - Train Loss: 0.5646
2025-07-31 17:00:46,612 - __main__ - INFO - Step 990/1312 - Train Loss: 0.5394
2025-07-31 17:01:52,148 - __main__ - INFO - Step 1000/1312 - Train Loss: 0.4911
2025-07-31 17:02:57,778 - __main__ - INFO - Step 1010/1312 - Train Loss: 0.4853
2025-07-31 17:04:03,457 - __main__ - INFO - Step 1020/1312 - Train Loss: 0.4928
2025-07-31 17:05:09,001 - __main__ - INFO - Step 1030/1312 - Train Loss: 0.5011
2025-07-31 17:06:14,691 - __main__ - INFO - Step 1040/1312 - Train Loss: 0.5082
2025-07-31 17:07:00,133 - __main__ - INFO - Step 1040/1312 - Eval Loss: 0.7069
2025-07-31 17:07:45,218 - __main__ - INFO - Step 1040: TR Loss: 0.6768, EN Loss: 0.7438, Avg Loss: 0.7103
2025-07-31 17:08:51,552 - __main__ - INFO - Step 1050/1312 - Train Loss: 0.4945
2025-07-31 17:09:58,026 - __main__ - INFO - Step 1060/1312 - Train Loss: 0.5036
2025-07-31 17:11:03,511 - __main__ - INFO - Step 1070/1312 - Train Loss: 0.4893
2025-07-31 17:12:08,803 - __main__ - INFO - Step 1080/1312 - Train Loss: 0.5075
2025-07-31 17:13:14,219 - __main__ - INFO - Step 1090/1312 - Train Loss: 0.4841
2025-07-31 17:14:19,558 - __main__ - INFO - Step 1100/1312 - Train Loss: 0.4907
2025-07-31 17:15:37,534 - __main__ - INFO - Step 1105/1312 - Eval Loss: 0.7054
2025-07-31 17:16:22,362 - __main__ - INFO - Step 1105: TR Loss: 0.6761, EN Loss: 0.7413, Avg Loss: 0.7087
2025-07-31 17:16:55,784 - __main__ - INFO - Step 1110/1312 - Train Loss: 0.4958
2025-07-31 17:18:01,173 - __main__ - INFO - Step 1120/1312 - Train Loss: 0.4981
2025-07-31 17:19:06,466 - __main__ - INFO - Step 1130/1312 - Train Loss: 0.4959
2025-07-31 17:20:11,824 - __main__ - INFO - Step 1140/1312 - Train Loss: 0.5033
2025-07-31 17:21:17,248 - __main__ - INFO - Step 1150/1312 - Train Loss: 0.5009
2025-07-31 17:22:22,516 - __main__ - INFO - Step 1160/1312 - Train Loss: 0.5131
2025-07-31 17:23:27,910 - __main__ - INFO - Step 1170/1312 - Train Loss: 0.5104
2025-07-31 17:24:13,093 - __main__ - INFO - Step 1170/1312 - Eval Loss: 0.7036
2025-07-31 17:24:57,915 - __main__ - INFO - Step 1170: TR Loss: 0.6750, EN Loss: 0.7387, Avg Loss: 0.7069
2025-07-31 17:24:58,639 - __main__ - INFO - Saving final model...
2025-07-31 17:24:59,364 - __main__ - INFO - ✓ Method 1 successful: Saved to /home/arda/cengbot-llama-3b-lora-v1/final-best-model/method1
2025-07-31 17:24:59,841 - __main__ - INFO - ✓ Method 2 successful: Saved to /home/arda/cengbot-llama-3b-lora-v1/final-best-model/method2
2025-07-31 17:24:59,846 - __main__ - ERROR - ✗ Method 3 failed: Parent directory /home/arda/cengbot-llama-3b-lora-v1/final-best-model/method3 does not exist.
2025-07-31 17:24:59,847 - __main__ - INFO - Successfully saved model using 2/3 methods
2025-07-31 17:24:59,917 - __main__ - WARNING - Failed to save metrics history: dict contains fields not in fieldnames: 'eval_samples_per_second', 'eval_loss', 'eval_runtime', 'eval_steps_per_second'
2025-07-31 17:24:59,917 - __main__ - INFO - Training completed successfully!
